AVX2 is enabled.

--- TRIG SPEED TEST (15500000 samples, unified inputs) ---

std::sin/cos pair (calls)        : 537.028000000000 ms    (sink=-3.62904934626310364e+02)
btrigdouble::sincos (calls)      : 250.449100000000 ms    (sink=-3.62904934625707767e+02)
btrig::sincos precise (calls)    : 136.177000000000 ms    (sink=-3.62904934625657972e+02)
btrig::sincos fast (calls)       : 82.202900000000  ms    (sink=-3.62931521939418190e+02)

std::sin only (calls)            : 325.657800000000 ms    (sink=1.42339688849528761e+03)
btrig::sin fast (calls)          : 72.959800000000  ms    (sink=1.42338990920109609e+03)
btrig::sin precise (calls)       : 112.096300000000 ms    (sink=1.42339688849529989e+03)

std::cos only (calls)            : 335.283200000000 ms    (sink=-1.78630182312145098e+03)
btrig::cos fast (calls)          : 73.650900000000  ms    (sink=-1.78632143114088990e+03)
btrig::cos precise (calls)       : 123.849600000000 ms    (sink=-1.78630182312087027e+03)

btrig::sincos array fast (scalar) : 113.206000000000 ms    (sink=-3.62931842910394039e+02)
btrig::sincos array precise (scalar) : 145.463500000000 ms    (sink=-3.62905255595405038e+02)
btrig::sincos_batch fast (AVX2)  : 93.960100000000  ms    (sink=-3.62931842910415526e+02)
btrig::sincos_batch precise (AVX2) : 102.838100000000 ms    (sink=-3.62905255595392475e+02)

--- END TEST ---

=== ACCURACY REPORT vs std:: ===
btrigdouble::sincos precise        max_abs=3.33066907387546962e-16  rms=1.17532901213129385e-16  max_ulp=3  avg_ulp=0.669  N_ulp=20666950  @i=154
btrig::sincos precise              max_abs=6.66133814775093924e-16  rms=1.71267853207692702e-16  max_ulp=5  avg_ulp=0.919  N_ulp=20666950  @i=3454
btrig::sincos fast                 max_abs=1.97108371891019374e-05  rms=7.42197049651226685e-06  max_ulp=174190349216  avg_ulp=39739069970.876  N_ulp=20666950  @i=78280
btrig::sin precise                 max_abs=6.66133814775093924e-16  rms=1.66140893348031055e-16  max_ulp=5  avg_ulp=0.925  N_ulp=10335210  @i=3454
btrig::sin fast                    max_abs=1.97107036280438908e-05  rms=7.42166947075326558e-06  max_ulp=172310241147  avg_ulp=39739529515.686  N_ulp=10335210  @i=10210519
btrig::cos precise                 max_abs=6.10622663543836097e-16  rms=1.76245733685278211e-16  max_ulp=5  avg_ulp=0.913  N_ulp=10331740  @i=2594
btrig::cos fast                    max_abs=1.97108371891019374e-05  rms=7.42227151006288569e-06  max_ulp=174190349216  avg_ulp=39738610271.724  N_ulp=10331740  @i=78280
=== END ACCURACY REPORT ===

--- RANDOM ANGLE CHECK (std vs btrig precise, 10 samples) ---
#  angle (rad)             std cos                 std sin                 btrig cos (prec)        btrig sin (prec)        |cos diff|              |sin diff|
  1    -4.08957083717385927    -0.58332647627932577     0.81223778665581992    -0.58332647627932543     0.81223778665582014     0.00000000000000033     0.00000000000000022
  2     1.35062738873540766     0.21839448618729110     0.97586056811564481     0.21839448618729113     0.97586056811564481     0.00000000000000003     0.00000000000000000
  3    -3.69365479694255061    -0.85144485417670990     0.52444414411451035    -0.85144485417670990     0.52444414411451035     0.00000000000000000     0.00000000000000000
  4     1.10320877360697267     0.45073410851504081     0.89265825679324307     0.45073410851504075     0.89265825679324307     0.00000000000000006     0.00000000000000000
  5     2.27689564808195577    -0.64887069358152627     0.76089869431549761    -0.64887069358152627     0.76089869431549750     0.00000000000000000     0.00000000000000011
  6     3.89973472922532416    -0.72611472291842893    -0.68757356636296962    -0.72611472291842905    -0.68757356636296962     0.00000000000000011     0.00000000000000000
  7     2.25835677389246392    -0.63465379448525427     0.77279658458450018    -0.63465379448525439     0.77279658458450018     0.00000000000000011     0.00000000000000000
  8     1.82672506674469659    -0.25314400727771480     0.96742860800132446    -0.25314400727771480     0.96742860800132446     0.00000000000000000     0.00000000000000000
  9    -1.13157332814531841     0.42523634329617371    -0.90508234561287226     0.42523634329617405    -0.90508234561287204     0.00000000000000033     0.00000000000000022
 10     0.27261211964756793     0.96307087474780639     0.26924800874378801     0.96307087474780639     0.26924800874378801     0.00000000000000000     0.00000000000000000
=== AUDIT: floor/residual ===
=== END AUDIT: floor/residual ===
=== AUDIT: LUT radius and continuity ===
LUT radius OK (all anchors unit within 1e-15)
Seam neighbor dot OK within 1e-15 at 115/116
=== END AUDIT: LUT ===
=== DUMP: seam window ===
idx=112  c=-0.92387953251128663  s=0.38268343236508978  r2=0.99999999999999978
idx=113  c=-0.93299279883473885  s=0.35989503653498828  r2=1
idx=114  c=-0.9415440651830207  s=0.33688985339222022  r2=1
idx=115  c=-0.94952818059303667  s=0.3136817403988913  r2=0.99999999999999989
idx=116  c=-0.95694033573220894  s=0.29028467725446228  r2=1
idx=117  c=-0.96377606579543995  s=0.26671275747489848  r2=1.0000000000000002
idx=118  c=-0.97003125319454397  s=0.24298017990326395  r2=1
=== END DUMP ===

=== TOP TROUBLE CASES (sorted by ULP error) ===
#    func  angle_rad              ulp_err       abs_err               ref_val                got_val                L_idx  L_d(rad)      L_a1        L_a2        C_idx  C_d(rad)      C_a1        C_a2        ulp_unit@ref
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    1   cos    5.41753885107059219             5          5.551115e-16    0.64814796550301756    0.64814796550301812    220  1.792648e-02 0.634393284-0.773010453    221 -6.617215e-03 0.653172843-0.757208847  1.110223e-16
    2   cos    4.10523302089112718             5          5.551115e-16   -0.57053403424258198   -0.57053403424258142    167  6.436356e-03-0.575808191-0.817584813    167  6.436356e-03-0.575808191-0.817584813  1.110223e-16
    3   cos    5.40790695217179973             5          5.551115e-16    0.64078318375584031    0.64078318375584087    220  8.294579e-03 0.634393284-0.773010453    220  8.294579e-03 0.634393284-0.773010453  1.110223e-16
    4   sin    5.68113690469243870             5          5.551115e-16   -0.56633190713289983   -0.56633190713289927    231  1.154391e-02 0.817584813-0.575808191    231  1.154391e-02 0.817584813-0.575808191  1.110223e-16
    5   sin    5.67558002299124631             5          5.551115e-16   -0.57090299530781008   -0.57090299530780952    231  5.987031e-03 0.817584813-0.575808191    231  5.987031e-03 0.817584813-0.575808191  1.110223e-16
    6   sin   -0.63029926488643717             5          5.551115e-16   -0.58938654581742655   -0.58938654581742711    230  7.836743e-03 0.803207531-0.595699304    230  7.836743e-03 0.803207531-0.595699304  1.110223e-16
    7   cos    4.11159715158892602             5          5.551115e-16   -0.56529582081941254   -0.56529582081941199    167  1.280049e-02-0.575808191-0.817584813    168 -1.174321e-02-0.555570233-0.831469612  1.110223e-16
    8   cos   -2.19376995153097720             5          5.551115e-16   -0.58345275719793754   -0.58345275719793810    166  1.516238e-02-0.595699304-0.803207531    166  1.516238e-02-0.595699304-0.803207531  1.110223e-16
    9   cos    4.11568809912127875             5          5.551115e-16   -0.56191652530967451   -0.56191652530967395    167  1.689143e-02-0.575808191-0.817584813    168 -7.652259e-03-0.555570233-0.831469612  1.110223e-16
   10   cos   -2.20355059582564650             5          5.551115e-16   -0.59136804564657008   -0.59136804564657064    166  5.381739e-03-0.595699304-0.803207531    166  5.381739e-03-0.595699304-0.803207531  1.110223e-16
   11   cos   -2.19234420956916409             5          5.551115e-16   -0.58229425241479038   -0.58229425241479094    166  1.658812e-02-0.595699304-0.803207531    166  1.658812e-02-0.595699304-0.803207531  1.110223e-16
   12   cos   -2.20245630809984316             5          5.551115e-16   -0.59048525617876713   -0.59048525617876768    166  6.476026e-03-0.595699304-0.803207531    166  6.476026e-03-0.595699304-0.803207531  1.110223e-16
   13   sin    5.69259589421140788             5          5.551115e-16   -0.55685069345444027   -0.55685069345443972    231  2.300290e-02 0.817584813-0.575808191    232 -1.540790e-03 0.831469612-0.555570233  1.110223e-16
   14   sin    5.67115277574455767             5          5.551115e-16   -0.57453223600530157   -0.57453223600530101    231  1.559784e-03 0.817584813-0.575808191    231  1.559784e-03 0.817584813-0.575808191  1.110223e-16
   15   cos    4.11344708443564677             5          5.551115e-16   -0.56376886651809266   -0.56376886651809210    167  1.465042e-02-0.575808191-0.817584813    168 -9.893273e-03-0.555570233-0.831469612  1.110223e-16
   16   cos   -2.19547884706730478             5          5.551115e-16   -0.58483977910755480   -0.58483977910755536    166  1.345349e-02-0.595699304-0.803207531    166  1.345349e-02-0.595699304-0.803207531  1.110223e-16
   17   sin    5.69035235824004282             5          5.551115e-16   -0.55871279971580401   -0.55871279971580345    231  2.075937e-02 0.817584813-0.575808191    232 -3.784326e-03 0.831469612-0.555570233  1.110223e-16
   18   cos    4.11844494071263334             5          5.551115e-16   -0.55963395020260620   -0.55963395020260565    167  1.964828e-02-0.575808191-0.817584813    168 -4.895417e-03-0.555570233-0.831469612  1.110223e-16
   19   sin    5.68485596028731877             5          5.551115e-16   -0.56326283654499387   -0.56326283654499332    231  1.526297e-02 0.817584813-0.575808191    232 -9.280724e-03 0.831469612-0.555570233  1.110223e-16
   20   cos   -2.19238771843392311             5          5.551115e-16   -0.58232962361817164   -0.58232962361817220    166  1.654462e-02-0.595699304-0.803207531    166  1.654462e-02-0.595699304-0.803207531  1.110223e-16

>>> Auto-tracing worst case (btrig cos), angle=5.4175388510705922, ULP=5

=== TRACE ANGLE ===
angle = 5.4175388510705922
[current] t=220.7303904103097  i=220  idx=220  d=0.017926477713135269
[anchor ] c=0.63439328416364571  s=-0.77301045336273677  r2=1
[micro  ] dx=0.99983932500132711  dy=0.017925517590589551  len2=1
[result ] cos=0.64814796550301801  sin=-0.76151442193454122
[std    ] cos=0.64814796550301756  sin=-0.76151442193454166
[ULP    ] cos=4  sin=4    |dc|=4.441e-16 |ds|=4.441e-16
[control] idx=220  d=0.017926477713135269  (c,s)=(0.63439328416364571,-0.77301045336273677)
[control] cos=0.64814796550301801  sin=-0.76151442193454122  ULPc=4  ULPs=4
[delta   ] dcos=0.000e+00  dsin=0.000e+00  (current - control)

[mini-sweep around angle]
   k    d(rad)            ULPc   ULPs
 -10  -0.0049087385212340517        4       4
  -9  -0.0044178646691106467        4       4
  -8  -0.0039269908169872417        4       3
  -7  -0.0034361169648638367        4       3
  -6  -0.0029452431127404313        4       3
  -5  -0.0024543692606170259        4       4
  -4  -0.0019634954084936209        4       3
  -3  -0.0014726215563702157        4       4
  -2  -0.00098174770424681044        4       4
  -1  -0.00049087385212340522        4       3
   0  +0        5       4
   1  +0.00049087385212340522        5       4
   2  +0.00098174770424681044        3       4
   3  +0.0014726215563702157        4       4
   4  +0.0019634954084936209        4       4
   5  +0.0024543692606170259        4       3
   6  +0.0029452431127404313        4       3
   7  +0.0034361169648638367        4       3
   8  +0.0039269908169872417        4       3
   9  +0.0044178646691106467        4       3
  10  +0.0049087385212340517        4       4
=== END TRACE ===
=== btrigdouble ===

=== TOP TROUBLE CASES (sorted by ULP error) ===
#    func  angle_rad              ulp_err       abs_err               ref_val                got_val                L_idx  L_d(rad)      L_a1        L_a2        C_idx  C_d(rad)      C_a1        C_a2        ulp_unit@ref
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    1   cos   -5.31019599876385495             3          3.330669e-16    0.56283117128141691    0.56283117128141724     39  1.578530e-02 0.575808191 0.817584813     39  1.578530e-02 0.575808191 0.817584813  1.110223e-16
    2   cos   -5.41501829178345062             3          3.330669e-16    0.64622646637502368    0.64622646637502401     35  9.137774e-03 0.653172843 0.757208847     35  9.137774e-03 0.653172843 0.757208847  1.110223e-16
    3   cos   -5.50683193972880058             3          3.330669e-16    0.71347340711592744    0.71347340711592777     31  1.549890e-02 0.724247083 0.689540545     31  1.549890e-02 0.724247083 0.689540545  1.110223e-16
    4   cos   -5.41498927869988389             3          3.330669e-16    0.64620432489317581    0.64620432489317614     35  9.166787e-03 0.653172843 0.757208847     35  9.166787e-03 0.653172843 0.757208847  1.110223e-16
    5   cos    5.85522059151293739             3          3.330669e-16    0.90981231706115850    0.90981231706115884    238  1.382175e-02 0.903989293-0.427555093    239 -1.072194e-02 0.914209756-0.405241314  1.110223e-16
    6   cos   -5.49849482875296935             3          3.330669e-16    0.70760701292069617    0.70760701292069650     31  2.383601e-02 0.724247083 0.689540545     31  2.383601e-02 0.724247083 0.689540545  1.110223e-16
    7   cos   -5.51118923638410507             3          3.330669e-16    0.71651970512936369    0.71651970512936403     31  1.114160e-02 0.724247083 0.689540545     31  1.114160e-02 0.724247083 0.689540545  1.110223e-16
    8   sin   -5.49469570851824773             3          3.330669e-16    0.70928937364620182    0.70928937364620148     32  3.091435e-03 0.707106781 0.707106781     32  3.091435e-03 0.707106781 0.707106781  1.110223e-16
    9   sin    5.62271307104941975             3          3.330669e-16   -0.61348984646916982   -0.61348984646916949    229  2.207464e-03 0.788346428-0.615231591    229  2.207464e-03 0.788346428-0.615231591  1.110223e-16
   10   cos   -5.32503080417389985             3          3.330669e-16    0.57503082412748063    0.57503082412748097     39  9.504914e-04 0.575808191 0.817584813     39  9.504914e-04 0.575808191 0.817584813  1.110223e-16
   11   cos   -5.41265378677129227             3          3.330669e-16    0.64442019974420761    0.64442019974420794     35  1.150228e-02 0.653172843 0.757208847     35  1.150228e-02 0.653172843 0.757208847  1.110223e-16
   12   cos   -5.44993439410599656             3          3.330669e-16    0.67247324736760250    0.67247324736760283     33  2.330906e-02 0.689540545 0.724247083     33  2.330906e-02 0.689540545 0.724247083  1.110223e-16
   13   cos    5.26080746229323459             3          3.330669e-16    0.52133829286529210    0.52133829286529243    214  8.457245e-03 0.514102744-0.857728610    214  8.457245e-03 0.514102744-0.857728610  1.110223e-16
   14   cos   -5.50942430415478501             3          3.330669e-16    0.71528743157635499    0.71528743157635533     31  1.290653e-02 0.724247083 0.689540545     31  1.290653e-02 0.724247083 0.689540545  1.110223e-16
   15   cos   -5.61361475010960387             3          3.330669e-16    0.78408827163774830    0.78408827163774864     27  6.890857e-03 0.788346428 0.615231591     27  6.890857e-03 0.788346428 0.615231591  1.110223e-16
   16   cos   -5.40546026931655010             3          3.330669e-16    0.63890289568101866    0.63890289568101899     35  1.869580e-02 0.653172843 0.757208847     35  1.869580e-02 0.653172843 0.757208847  1.110223e-16
   17   sin   -5.49540192985956466             3          3.330669e-16    0.70879136907546514    0.70879136907546481     32  2.385214e-03 0.707106781 0.707106781     32  2.385214e-03 0.707106781 0.707106781  1.110223e-16
   18   cos   -5.50789935466179781             3          3.330669e-16    0.71422091927648523    0.71422091927648557     31  1.443148e-02 0.724247083 0.689540545     31  1.443148e-02 0.724247083 0.689540545  1.110223e-16
   19   cos   -5.51399483330985518             3          3.330669e-16    0.71847397398015800    0.71847397398015833     31  8.336003e-03 0.724247083 0.689540545     31  8.336003e-03 0.724247083 0.689540545  1.110223e-16
   20   cos   -5.48865241611940569             3          3.330669e-16    0.70061814170275849    0.70061814170275882     32  9.134728e-03 0.707106781 0.707106781     32  9.134728e-03 0.707106781 0.707106781  1.110223e-16

C:\Users\Brennon\source\repos\TrigTest\x64\Release\TrigTest.exe (process 18356) exited with code 0 (0x0).
Press any key to close this window . . .